var MT=window.MT||{};MT.namespace=function(){var a=arguments,o=null,i,j,d;for(i=0;i<a.length;++i){d=a[i].split(".");o=MT;for(j=(d[0]=="MT")?1:0;j<d.length;++j){o[d[j]]=o[d[j]]||{};o=o[d[j]];}}return o;};MT.namespace("util","app","widget");(function(){var $C=YAHOO.util.Connect;var $D=YAHOO.util.Dom;var $E=YAHOO.util.Event;var _9=YAHOO.util.KeyListener;var _a=YAHOO.env.ua.ie;var _b=(_a==6);var _c=YAHOO.env.ua.gecko;var _d=YAHOO.env.ua.webkit;var _e=YAHOO.env.ua.opera;var _f=YAHOO.lang.isString;var _10=YAHOO.lang.trim;MT.util={breakWord:function(el){el=$D.get(el);if(!el||el.nodeType!==1){return false;}if(el.currentStyle&&typeof el.currentStyle.wordBreak==="string"){el.runtimeStyle.wordBreak="break-all";return true;}else{if(document.createTreeWalker){var _12=document.createTreeWalker(el,NodeFilter.SHOW_TEXT,null,false);var _13,s,c=String.fromCharCode("8203");while(_12.nextNode()){_13=_12.currentNode;s=_10(_13.nodeValue).split("").join(c);_13.nodeValue=s;}return true;}else{return false;}}},fixTextareaCursorPosition:function(_16){if(_f(_16)){_16=$D.get(_16);}if(_a||_e){var rng=_16.createTextRange();rng.text=_16.value;rng.collapse(false);}else{if(_d){_16.select();window.getSelection().collapseToEnd();}}},focusTextarea:function(_18){try{_18.focus();this.fixTextareaCursorPosition(_18);}catch(e){}},checkCapsLock:function(e){e=(e)?e:window.event;var _1a=false;if(e.which){_1a=e.which;}else{if(e.keyCode){_1a=e.keyCode;}}var _1b=false;if(e.shiftKey){_1b=e.shiftKey;}else{if(e.modifiers){_1b=!!(e.modifiers&4);}}if(_1a>=97&&_1a<=122&&_1b){return true;}if(_1a>=65&&_1a<=90&&!_1b){return true;}return false;},getEvalRes:function(o,_1d){try{return eval("("+o.responseText+")");}catch(ex){return {"status":0,"msg":_1d||"\u7f51\u7edc\u6709\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002"};}},ctrlEnter:function(el,_1f){var _20=new YAHOO.util.KeyListener(el,{ctrl:true,keys:[13,100]},function(){_1f();_20.disable();window.setTimeout(function(){_20.enable();},2000);});_20.enable();},yFadeRemove:function(_21,_22){var p=$D.getAncestorByTagName(_21,_22);if(!p){return;}MT.util.Effect.yellowFadeOut(p,function(el){el.parentNode.removeChild(el);if(_a){MT.util.reFlow();}});},reFlow:function(){if(_a){document.body.style.zoom=1.1;document.body.style.zoom="";}},getLength:function(str){if(!str){return 0;}for(var i=0,_27=0,len=str.length;i<len;i++){_27=str.charCodeAt(i)>255?_27+2:_27+1;}return _27;},toFull:function(str){var ret="";for(var i=0,len=str.length;i<len;i++){var _2d=str.charCodeAt(i);if(_2d==32){ret+=String.fromCharCode(12288);}else{if(_2d<127){ret+=String.fromCharCode(_2d+65248);}else{ret+=str[i];}}}return ret;},toHalf:function(str){var ret="";for(var i=0,len=str.length;i<len;i++){var _32=str.charCodeAt(i);if(_32==12288){ret+=String.fromCharCode(32);}else{if(_32>65280&&_32<65375){ret+=String.fromCharCode(_32-65248);}else{ret+=String.fromCharCode(_32);}}}return ret;},toPostData:function(o){var arr=[];for(var i in o){arr.push(i+"="+o[i]);}return arr.join("&");},loadImage:function(src){var img=new Image();img.src=src;},pad:function(num,_39,_3a){if(!_3a){_3a="0";}var len=num.toString().length;while(len<_39){num=_3a+num;len++;}return num;},parseDate:function(_3c){var tmp=_3c.split(" ");var _3e=tmp[1]+" "+tmp[2]+", "+tmp[5]+" "+tmp[3];return Date.parse(_3e)-(new Date()).getTimezoneOffset()*60*1000;},getRelativeTime:function(_3f){var _40=_f(_3f)?this.parseDate(_3f).valueOf():_3f;var now=new Date();var _42=parseInt((now.getTime()-_40)/1000,10);if(_42<1){return "1 \u79d2\u524d";}else{if(_42<60){return _42+" \u79d2\u524d";}else{if(_42<60*60){return parseInt(_42/60,10)+" \u5206\u949f\u524d";}else{if(_42<60*60*24){return "\u7ea6 "+parseInt(_42/3600,10)+" \u5c0f\u65f6\u524d";}else{return this.getFullTime(_3f);}}}}},getFullTime:function(_43){var d=new Date(_f(_43)?this.parseDate(_43):_43);var _45=d.getFullYear();var _46=this.pad(d.getMonth()+1,2);var _47=this.pad(d.getDate(),2);var _48=this.pad(d.getHours(),2);var _49=this.pad(d.getMinutes(),2);return _45+"-"+_46+"-"+_47+" "+_48+":"+_49;},getText:function(el){if(_f(el)){el=$D.get(el);}var _4b=el.innerText||el.textContent;return _10(_4b);},getRadioValue:function(_4c,_4d){if(_f(_4c)){_4c=$D.get(_4c);}var r=_4c[_4d];if(!r){return;}var n=r.length;if(n){for(var i=0;i<n;++i){if(r[i].checked){return r[i].value;}}}return r.value;},fixIE6Png:function(_51){if(!_b){return;}if(_f(_51)){_51=$D.get(_51);}$D.getElementsBy(function(img){return /.png$/i.test(img.src);},"img",_51,function(img){img.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src=\""+img.src+"\", sizingMethod=\"crop\");";img.src="/static/img/importantblk.gif";});},Effect:{_yfade:function(el,_55,_56,_57){var a=arguments,f="#fff478",t="#ffffff";if(YAHOO.lang.isArray(a[2])){f=a[2][0]?a[2][0]:f;t=a[2][1]?a[2][1]:t;}else{if(YAHOO.lang.isFunction(a[2])){var cb=a[2];}}if(YAHOO.lang.isFunction(a[3])){var cb=a[3];}var opa=_55=="out"?{from:1,to:0}:{from:0,to:1};var _5d=new YAHOO.util.ColorAnim(el,{backgroundColor:{from:f,to:t},opacity:opa},1,YAHOO.util.Easing.easeNone);if("undefined"!=typeof cb){_5d.onComplete.subscribe(function(){cb(el);});}_5d.animate();return _5d;},yellowFadeOut:function(el,_5f,_60){return MT.util.Effect._yfade(el,"out",_5f,_60);},yellowFadeIn:function(el,_62,_63){return MT.util.Effect._yfade(el,"in",_62,_63);}}};MT.widget={selectAndCopy:function(_64,_65,_66){if(_f(_64)){_64=$D.get(_64);}var _67="flashcopier",_68="flashembed";function copy(_69){if(!$D.get(_67)){var _6a=document.createElement("div");_6a.id=_67;document.body.appendChild(_6a);}var _6b=$D.get(_67);_6b.innerHTML="<embed src=\"http://static.fanfou.com/swf/cp.swf\" FlashVars=\"clipboard="+encodeURIComponent(_69.value)+"\" width=\"0\" height=\"0\" type=\"application/x-shockwave-flash\" id=\""+_68+"\"></embed>";var _6c=window[_68]||document[_68]||{};if(!_6c.SetVariable){try{return window.clipboardData.setData("Text",_69.value);}catch(exx){return false;}}return true;}$E.on(_64,"click",doCopy);$E.on(_65,"click",doCopy);function doCopy(){if(_a&&copy(_64)){alert(_66||"\u590d\u5236\u6210\u529f\uff0c\u4f60\u53ef\u4ee5\u7c98\u5e16\u5230MSN\u6216QQ\u4e2d\u53d1\u7ed9\u597d\u53cb\u3002");}setTimeout(function(){_64.select();},0);}},showMessage:function(_6d,_6e){var _6f=$D.getElementsByClassName("sysmsgw","div","doc");if(_6f.length){_6f=_6f[0];}else{_6f=document.createElement("div");_6f.className="sysmsgw";_6f.innerHTML="<div class=\"sysmsg\"><p></p><span class=\"close\" onclick=\"MT.app.Core.removeFromCloseButton(this)\">\u5173\u95ed</span></div>";$D.insertAfter(_6f,"hdw");}_6f.id="sysmsg-"+_6d;var p=_6f.getElementsByTagName("p")[0];p.innerHTML=_6e;},removeMessage:function(){var _71=$D.getElementsByClassName("sysmsgw","div","doc");if(_71.length){_71=_71[0];_71.parentNode.removeChild(_71);}},_makeCouponSMSForm:function(_72,_73){var _74=document.createElement("form");_73=_73?_73:"";_74.style.display="none";var _75="<div><input type=\"text\" class=\"f-input\" name=\"mobile\" maxlength=\"11\" value=\""+_73+"\" autocomplete=\"off\" /><br /><input type=\"submit\" class=\"formbutton";if(!_73){_75+=" disabled\" disabled=\"disabled\"";}_75+="\" value=\"\u53d1\u9001\" /></div><p></p>";_74.innerHTML=_75;var _76=$D.getElementsByClassName("f-input","input",_74)[0];var _77=$D.getElementsByClassName("formbutton","input",_74)[0];var div=_74.getElementsByTagName("div")[0];var p=_74.getElementsByTagName("p")[0];function check(e){if(/^[0-9]{11}$/.test(_76.value)){_77.disabled=false;$D.removeClass(_77,"disabled");}else{_77.disabled=true;$D.addClass(_77,"disabled");}}$E.on(_76,"keyup",check);$E.on(_76,"change",check);$E.on(_74,"submit",function(e){$E.stopEvent(e);$C.setForm(_74);var _7c=$C.asyncRequest("POST","/coupon/sms/"+_72,{success:function(o){var ret=MT.util.getEvalRes(o,"\u672a\u77e5\u9519\u8bef");div.style.display=ret.status==1?"none":"block";p.style.display="block";var _7f=ret.status==1?"sendsms-success":"sendsms-failure";p.innerHTML="<span class=\""+_7f+"\">"+ret.msg+"</span>";},failure:function(o){div.style.display="block";p.style.display="block";p.innerHTML="<span class=\"sendsms-failure\">\u8fde\u63a5\u8d85\u65f6</span>";},timeout:18000});if($C.isCallInProgress(_7c)){div.style.display="none";p.innerHTML="<img src=\"/static/css/i/indicator-large.gif\">";}});return _74;},sendCouponSMS:function(el,_82,_83){var _84=el.parentNode.getElementsByTagName("form");if(_84.length){_84=_84[0];}else{_84=this._makeCouponSMSForm(_82,_83);el.parentNode.appendChild(_84);}if(_84.style.display=="none"){_84.style.display="block";_84.mobile.focus();}else{_84.style.display="none";}},startMsnChat:function(_85){try{window.setTimeout(function(){var frm=document.createElement("form");$D.get("doc").appendChild(frm);frm.method="post";frm.action="msnim:chat?contact="+_85;frm.submit();},100);}catch(e){alert(e);}}};MT.ga={init:function(){},setRules:function(_87){},trackClick:function(_88){}};MT.app.Core={removeFromCloseButton:function(_89){var p=$D.getAncestorByClassName(_89,"sysmsgw");p.parentNode.removeChild(p);},removeTip:function(){var _8b=$D.get("sysmsg-tip");var _8c=$D.get("sysmsg-tip-close");if(!_8b||!_8c){return;}$E.on(_8c,"click",function(e){_8b.parentNode.removeChild(_8b);});},sysmsg:function(){this.removeTip();var _8e=$D.get("sysmsg-error");if(!_8e){_8e=$D.get("sysmsg-success");}if(!_8e){return;}$D.getElementsByClassName("close","span",_8e,function(el){$E.on(el,"click",function(e){MT.app.Core.removeFromCloseButton(el);});});},initAccountMenu:function(){var _91=$D.get("myaccount");var _92=$D.get("myaccount-menu");var _93=false;$E.on(_91,"click",function(e){_91.blur();$E.stopEvent(e);});$E.on(_91,"mouseover",function(e){_92.style.display="block";});$E.on(_91,"mouseout",function(e){handleOut(e);});$E.on(_92,"mouseout",function(e){handleOut(e);});function handleOut(e){var _99=$E.getTarget(e);var _9a=$E.getRelatedTarget(e);if(_92==_9a||$D.isAncestor(_92,_9a)){$D.addClass(_91,"hover");}else{$D.removeClass(_91,"hover");_92.style.display="none";}}},changeCity:function(){var _9b=$D.get("guides-city-change");var _9c=$D.get("guides-city-list");if(!_9b||!_9c){return;}$E.on(_9b,"click",function(e){if($D.getStyle(_9c,"display")=="none"){_9c.style.display="block";}else{_9c.style.display="none";}});$E.on(document,"click",function(e){var _9f=$E.getTarget(e);var _a0=_9f.nodeName.toLowerCase();if(_9f!=_9b&&!$D.isAncestor(_9c,_9f)){window.setTimeout(function(){_9c.style.display="none";},10);}});},msnHelp:function(){$E.on("service-msn-help","click",function(e){if(_a){$E.stopEvent(e);MT.widget.startMsnChat("help@meituan.com");}});},trackLink:function(){var _a2="gaevent";var _a3="galabel";$D.batch(document.getElementsByTagName("a"),function(el){trackCustomEvent(el);trackCommonEvent(el);});function trackCustomEvent(el){var _a6=el.getAttribute(_a2);if(_a6){var _a7=_a6.split("|");var _a8=_a7[0];var _a9=_a7[1];var _aa=_a7[2];var _ab=_a7[3];if(!_aa&&el.href){_aa=el.href.replace("http://","");}$E.on(el,"click",function(e){_gaq.push(["_trackEvent",_a8,_a9,_aa,_ab]);});}}function trackCommonEvent(el){var _ae=el.href;var reg=/^(http:\/\/|mailto:)/;if(_ae&&reg.test(_ae)){_ae=_ae.replace("http://","");var _b0=_ae.indexOf("?");var _b1=el.getAttribute(_a3);if(_b0>0){_ae=_ae.substring(0,_b0);}if(/\.(meituan|mt|fdpmt)\.com/.test(_ae)){return;}if(_b1){_ae+="#label="+_b1;}$E.on(el,"click",function(e){_gaq.push(["_trackEvent","OutLink","Click",_ae]);});}}},init:function(){this.sysmsg();this.initAccountMenu();this.changeCity();this.trackLink();this.msnHelp();}};$E.onDOMReady(function(){MT.app.Core.init();});})();